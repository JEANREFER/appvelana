(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[594],{7038:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my-vendors",function(){return a(8255)}])},8255:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return l}});var t=a(5893),n=a(7294),r=a(1163);function l(){let e=(0,r.useRouter)(),{id:s}=e.query,[a,l]=(0,n.useState)([]),[i,c]=(0,n.useState)({name:"",city:"",description:"",price:0,deposit:0,paid:!1,note:0}),[d,o]=(0,n.useState)(!1),p=JSON.parse(localStorage.getItem("user")||"{}"),u=async()=>{if(!s||!p.id)return;let e=await fetch("/api/user-vendors?userId=".concat(p.id,"&weddingId=").concat(s)),a=await e.json();console.log("Prestataires r\xe9cup\xe9r\xe9s:",a),l(a)};(0,n.useEffect)(()=>{s&&p.id&&u()},[s]);let m=e=>{let{name:s,value:a,type:t,checked:n}=e.target;c({...i,[s]:"checkbox"===t?n:a})},h=async e=>{e.preventDefault();let a=await fetch("/api/user-vendors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,weddingId:parseInt(Array.isArray(s)?s[0]:s),userId:p.id,custom:!0})});if(a.ok)u(),o(!1);else{let e=await a.json();alert("Erreur : "+e.message)}};return(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Mes prestataires"}),(0,t.jsx)("button",{onClick:()=>o(!0),className:"mb-4 bg-blue-600 text-white px-4 py-2 rounded",children:"Ajouter un prestataire personnalis\xe9"}),(0,t.jsxs)("table",{className:"w-full bg-white rounded shadow",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-2",children:"Nom"}),(0,t.jsx)("th",{className:"p-2",children:"Ville"}),(0,t.jsx)("th",{className:"p-2",children:"Prix"}),(0,t.jsx)("th",{className:"p-2",children:"Acompte"}),(0,t.jsx)("th",{className:"p-2",children:"Pay\xe9"}),(0,t.jsx)("th",{className:"p-2",children:"Note"}),(0,t.jsx)("th",{className:"p-2",children:"Description"})]})}),(0,t.jsx)("tbody",{children:a.map(e=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"p-2",children:e.name}),(0,t.jsx)("td",{className:"p-2",children:e.city||"-"}),(0,t.jsxs)("td",{className:"p-2",children:[e.price||0," €"]}),(0,t.jsxs)("td",{className:"p-2",children:[e.deposit||0," €"]}),(0,t.jsx)("td",{className:"p-2",children:e.paid?"✅":"❌"}),(0,t.jsx)("td",{className:"p-2",children:e.note||"-"}),(0,t.jsx)("td",{className:"p-2",children:e.description||""})]},e.id))})]}),d&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("form",{onSubmit:h,className:"bg-white p-6 rounded shadow-md w-full max-w-md",children:[(0,t.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Ajouter un prestataire personnalis\xe9"}),(0,t.jsx)("input",{name:"name",required:!0,placeholder:"Nom du prestataire",className:"w-full border p-2 mb-3 rounded",value:i.name,onChange:m}),(0,t.jsx)("input",{name:"city",placeholder:"Ville",className:"w-full border p-2 mb-3 rounded",value:i.city,onChange:m}),(0,t.jsx)("textarea",{name:"description",placeholder:"Description",className:"w-full border p-2 mb-3 rounded",value:i.description,onChange:m}),(0,t.jsx)("input",{type:"number",name:"price",placeholder:"Prix (€)",className:"w-full border p-2 mb-3 rounded",value:i.price,onChange:m}),(0,t.jsx)("input",{type:"number",name:"deposit",placeholder:"Acompte (€)",className:"w-full border p-2 mb-3 rounded",value:i.deposit,onChange:m}),(0,t.jsxs)("label",{className:"flex items-center mb-3",children:[(0,t.jsx)("input",{type:"checkbox",name:"paid",checked:i.paid,onChange:m,className:"mr-2"}),"Paiement complet effectu\xe9"]}),(0,t.jsx)("input",{type:"number",name:"note",min:"0",max:"5",placeholder:"Note (0-5)",className:"w-full border p-2 mb-4 rounded",value:i.note,onChange:m}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Enregistrer"}),(0,t.jsx)("button",{type:"button",onClick:()=>o(!1),className:"bg-gray-500 text-white px-4 py-2 rounded",children:"Annuler"})]})]})})]})}},1163:function(e,s,a){e.exports=a(6885)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=7038)}),_N_E=e.O()}]);